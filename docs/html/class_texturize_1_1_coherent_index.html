<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Texturize::CoherentIndex class | Texturize</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-texturize+doxygen.compiled.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">Texturize</a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-dox-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path d="m6 0c-3.3144 0-6 2.6856-6 6 0 3.3144 2.6856 6 6 6 1.4858 0 2.8463-0.54083 3.8945-1.4355-0.0164 0.33797 0.14734 0.75854 0.5 1.1504l3.2227 3.7891c0.55185 0.6139 1.4517 0.66544 2.002 0.11524 0.55022-0.55022 0.49866-1.4501-0.11524-2.002l-3.7891-3.2246c-0.39184-0.35266-0.81242-0.51469-1.1504-0.5 0.89472-1.0482 1.4355-2.4088 1.4355-3.8945 0-3.3128-2.6856-5.998-6-5.998zm0 1.5625a4.4375 4.4375 0 0 1 4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375-4.4375 4.4375 4.4375 0 0 1 4.4375-4.4375z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li>
              <a href="getting-started.html">Getting started</a>
              <ol>
                <li><a href="getting-started-build.html">Creating the project using CMake</a></li>
                <li><a href="getting-started-sandbox.html">Using the Sandbox application</a></li>
              </ol>
            </li>
            <li>
              <a href="tutorial.html">Tutorials</a>
              <ol>
                <li><a href="tutorial-filter.html">Implementing custom filters</a></li>
                <li><a href="tutorial-search-space.html">Creating a search space</a></li>
                <li><a href="tutorial-search-index.html">Implementing a search index</a></li>
                <li><a href="tutorial-synthesizer.html">Writing your own synthesizer</a></li>
              </ol>
            </li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="modules.html">Modules</a></li>
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="namespaces.html">Namespaces</a></li>
            <li class="m-show-m"><a href="#search" class="m-dox-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <path d="m6 0c-3.3144 0-6 2.6856-6 6 0 3.3144 2.6856 6 6 6 1.4858 0 2.8463-0.54083 3.8945-1.4355-0.0164 0.33797 0.14734 0.75854 0.5 1.1504l3.2227 3.7891c0.55185 0.6139 1.4517 0.66544 2.002 0.11524 0.55022-0.55022 0.49866-1.4501-0.11524-2.002l-3.7891-3.2246c-0.39184-0.35266-0.81242-0.51469-1.1504-0.5 0.89472-1.0482 1.4355-2.4088 1.4355-3.8945 0-3.3128-2.6856-5.998-6-5.998zm0 1.5625a4.4375 4.4375 0 0 1 4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375-4.4375 4.4375 4.4375 0 0 1 4.4375-4.4375z"/>
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="namespace_texturize.html">Texturize</a>::<wbr/></span>CoherentIndex <span class="m-thin">class</span>
        </h1>
        <p>Implements a search index, that matches pixel neighborhoods based on coherent pixels.</p>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li>
              Reference
              <ul>
                <li><a href="#base-classes">Base classes</a></li>
                <li><a href="#derived-classes">Derived classes</a></li>
                <li><a href="#typeless-methods">Constructors, destructors, conversion operators</a></li>
                <li><a href="#pub-methods">Public functions</a></li>
                <li><a href="#pro-types">Protected types</a></li>
                <li><a href="#pro-methods">Protected functions</a></li>
              </ul>
            </li>
          </ul>
        </div>
<p>Coherent pixels have first been described by Michael Ashikhmin and are based on the observation that typically good match candidates are direct neighbors of already synthesized pixels. By resolving the coordinates in the synthesized neighborhood of a pixel, those <em>coherent</em> pixels can be resolved efficiently, without performing a heavy knn-search for each result pixel. The following image demonstrates this approach.</p><img class="m-image" src="Coherence.svg" alt="Image" /><aside class="m-note m-default"><h4>See also</h4><p>Michael Ashikhmin. &quot;Synthesizing Natural Textures.&quot; In: Proceedings of the 2001 Symposium on Interactive 3D Graphics. I3D 2001. New York, NY, USA: ACM, 2001, pp. 217-226. isbn: 1-58113-292-1. doi: 10.1145/364338.364405. url: <a href="http://doi.acm.org/10.1145/364338.364405">http:/<wbr />/<wbr />doi.acm.org/<wbr />10.1145/<wbr />364338.364405</a>.</p></aside>
        <section id="base-classes">
          <h2><a href="#base-classes">Base classes</a></h2>
          <dl class="m-dox">
            <dt>
              class <a href="class_texturize_1_1_search_index.html" class="m-dox">SearchIndex</a>
            </dt>
            <dd>Implements a search index, based on pixel neighborhood appearances.</dd>
          </dl>
        </section>
        <section id="derived-classes">
          <h2><a href="#derived-classes">Derived classes</a></h2>
          <dl class="m-dox">
            <dt>
              class <a href="class_texturize_1_1_random_walk_index.html" class="m-dox">RandomWalkIndex</a>
            </dt>
            <dd>Implements a search index, that matches pixels by randomly walking coherent candidate neighborhoods.</dd>
          </dl>
        </section>
        <section id="typeless-methods">
          <h2><a href="#typeless-methods">Constructors, destructors, conversion operators</a></h2>
          <dl class="m-dox">
            <dt>
              <span class="m-dox-wrap-bumper"><a href="#a814641a32db72468a4e2038507790495" class="m-dox">CoherentIndex</a>(</span><span class="m-dox-wrap">const <a href="class_texturize_1_1_i_search_space.html" class="m-dox">ISearchSpace</a>* searchSpace,
              cv::NormTypes distanceMeasure = cv::NORM_L2SQR)</span>
            </dt>
            <dd>Creates a new search index.</dd>
          </dl>
        </section>
        <section id="pub-methods">
          <h2><a href="#pub-methods">Public functions</a></h2>
          <dl class="m-dox">
            <dt>
              <span class="m-dox-wrap-bumper">auto <a href="#a0f3d18c3d2238f62e7b7a45c89e49bb9" class="m-dox">findNearestNeighbor</a>(</span><span class="m-dox-wrap">const cv::Mat&amp; descriptors,
              const cv::Mat&amp; uv,
              const cv::Point2i&amp; at,
              cv::Vec2f&amp; match,
              float minDist = 0.0f,
              float* dist = nullptr) const override -&gt; bool <span class="m-label m-flat m-warning">virtual</span></span>
            </dt>
            <dd></dd>
            <dt>
              <span class="m-dox-wrap-bumper">auto <a href="#a65e32af19af1d5f808f98600e94896a0" class="m-dox">findNearestNeighbors</a>(</span><span class="m-dox-wrap">const cv::Mat&amp; descriptors,
              const cv::Mat&amp; uv,
              const cv::Point2i&amp; at,
              std::vector&lt;cv::Vec2f&gt;&amp; matches,
              const int k = 1,
              float minDist = 0.0f,
              std::vector&lt;float&gt;* dist = nullptr) const override -&gt; bool <span class="m-label m-flat m-warning">virtual</span></span>
            </dt>
            <dd></dd>
          </dl>
        </section>
        <section id="pro-types">
          <h2><a href="#pro-types">Protected types</a></h2>
          <dl class="m-dox">
            <dt>
              using <a href="#addb9caeb39b5aa69dfc24676f05ea576" class="m-dox-self" name="addb9caeb39b5aa69dfc24676f05ea576">TCandidate</a> = cv::Vec2f
            </dt>
            <dd>The type of a match candidate.</dd>
            <dt>
              using <a href="#adabd42ad5333153a1a2b6524d1abcf08" class="m-dox-self" name="adabd42ad5333153a1a2b6524d1abcf08">TDistance</a> = float
            </dt>
            <dd>The type of the similarity distance.</dd>
            <dt>
              using <a href="#a4de3432a308c040ee27da746301e7fcb" class="m-dox-self" name="a4de3432a308c040ee27da746301e7fcb">TMatch</a> = std::tuple&lt;<a href="class_texturize_1_1_coherent_index.html#addb9caeb39b5aa69dfc24676f05ea576" class="m-dox">TCandidate</a>, <a href="class_texturize_1_1_coherent_index.html#adabd42ad5333153a1a2b6524d1abcf08" class="m-dox">TDistance</a>&gt;
            </dt>
            <dd>Describes a match as a set of candidate coordinates and similarity.</dd>
          </dl>
        </section>
        <section id="pro-methods">
          <h2><a href="#pro-methods">Protected functions</a></h2>
          <dl class="m-dox">
            <dt>
              <span class="m-dox-wrap-bumper">auto <a href="#a80b2f9ca4896331036316d9534365f47" class="m-dox">measureVisualDistance</a>(</span><span class="m-dox-wrap">const std::vector&lt;float&gt;&amp; targetDescriptor,
              const cv::Point2i&amp; towards) const -&gt; <a href="class_texturize_1_1_coherent_index.html#adabd42ad5333153a1a2b6524d1abcf08" class="m-dox">TDistance</a></span>
            </dt>
            <dd>Calculates the similarity between a candidate and descriptor.</dd>
            <dt>
              <span class="m-dox-wrap-bumper">void <a href="#a8ad4525ba8a93e611c21089722e8f99d" class="m-dox">getCoherentCandidate</a>(</span><span class="m-dox-wrap">const std::vector&lt;float&gt;&amp; targetDescriptor,
              const cv::Mat&amp; uv,
              const cv::Point2i&amp; at,
              const cv::Vec2i&amp; delta,
              <a href="class_texturize_1_1_coherent_index.html#a4de3432a308c040ee27da746301e7fcb" class="m-dox">TMatch</a>&amp; match) const</span>
            </dt>
            <dd>Gets a coherent candidate from a neighborhood pixel.</dd>
          </dl>
        </section>
        <section>
          <h2>Function documentation</h2>
          <section class="m-dox-details" id="a814641a32db72468a4e2038507790495"><div>
            <h3>
              <span class="m-dox-wrap-bumper"> Texturize::<wbr />CoherentIndex::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#a814641a32db72468a4e2038507790495" class="m-dox-self">CoherentIndex</a>(</span><span class="m-dox-wrap">const <a href="class_texturize_1_1_i_search_space.html" class="m-dox">ISearchSpace</a>* searchSpace,
              cv::NormTypes distanceMeasure = cv::NORM_L2SQR)</span></span>
            </h3>
            <p>Creates a new search index.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">searchSpace</td>
                  <td>A reference of a search space instance.</td>
                </tr>
                <tr>
                  <td>distanceMeasure</td>
                  <td>The type of norm to use to measure similarity between a candidate and a descriptor.</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-dox-details" id="a0f3d18c3d2238f62e7b7a45c89e49bb9"><div>
            <h3>
              <span class="m-dox-wrap-bumper">bool Texturize::<wbr />CoherentIndex::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#a0f3d18c3d2238f62e7b7a45c89e49bb9" class="m-dox-self">findNearestNeighbor</a>(</span><span class="m-dox-wrap">const cv::Mat&amp; descriptors,
              const cv::Mat&amp; uv,
              const cv::Point2i&amp; at,
              cv::Vec2f&amp; match,
              float minDist = 0.0f,
              float* dist = nullptr) const override <span class="m-label m-warning">virtual</span></span></span>
            </h3>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">descriptors</td>
                  <td></td>
                </tr>
                <tr>
                  <td>uv</td>
                  <td></td>
                </tr>
                <tr>
                  <td>at</td>
                  <td></td>
                </tr>
                <tr>
                  <td>match</td>
                  <td></td>
                </tr>
                <tr>
                  <td>minDist</td>
                  <td>A lower thresold for similarity measures.</td>
                </tr>
                <tr>
                  <td>dist</td>
                  <td>The similarity between the candidate and the match.</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-dox-details" id="a65e32af19af1d5f808f98600e94896a0"><div>
            <h3>
              <span class="m-dox-wrap-bumper">bool Texturize::<wbr />CoherentIndex::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#a65e32af19af1d5f808f98600e94896a0" class="m-dox-self">findNearestNeighbors</a>(</span><span class="m-dox-wrap">const cv::Mat&amp; descriptors,
              const cv::Mat&amp; uv,
              const cv::Point2i&amp; at,
              std::vector&lt;cv::Vec2f&gt;&amp; matches,
              const int k = 1,
              float minDist = 0.0f,
              std::vector&lt;float&gt;* dist = nullptr) const override <span class="m-label m-warning">virtual</span></span></span>
            </h3>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">descriptors</td>
                  <td></td>
                </tr>
                <tr>
                  <td>uv</td>
                  <td></td>
                </tr>
                <tr>
                  <td>at</td>
                  <td></td>
                </tr>
                <tr>
                  <td>matches</td>
                  <td></td>
                </tr>
                <tr>
                  <td>k</td>
                  <td>The number of coherent candidates to return. Must be a value between 1 and 8.</td>
                </tr>
                <tr>
                  <td>minDist</td>
                  <td>A lower thresold for similarity measures.</td>
                </tr>
                <tr>
                  <td>dist</td>
                  <td>The similarity between the candidate and the match.</td>
                </tr>
              </tbody>
            </table>
          </div></section>
          <section class="m-dox-details" id="a80b2f9ca4896331036316d9534365f47"><div>
            <h3>
              <span class="m-dox-wrap-bumper"><a href="class_texturize_1_1_coherent_index.html#adabd42ad5333153a1a2b6524d1abcf08" class="m-dox">TDistance</a> Texturize::<wbr />CoherentIndex::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#a80b2f9ca4896331036316d9534365f47" class="m-dox-self">measureVisualDistance</a>(</span><span class="m-dox-wrap">const std::vector&lt;float&gt;&amp; targetDescriptor,
              const cv::Point2i&amp; towards) const <span class="m-label m-warning">protected</span></span></span>
            </h3>
            <p>Calculates the similarity between a candidate and descriptor.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">targetDescriptor</td>
                  <td>The descriptor to compare against a candidate from the exemplar sample.</td>
                </tr>
                <tr>
                  <td>towards</td>
                  <td>The point from which the candidate descriptor should be compared towards the provided target.</td>
                </tr>
              </tbody>
              <tfoot>
                <tr>
                  <th>Returns</th>
                  <td>A value, describing the similarity between the target descriptor and exemplar descriptor at the provided point. The similarity is measured by the norm, the index has been initialized with.</td>
                </tr>
              </tfoot>
            </table>
          </div></section>
          <section class="m-dox-details" id="a8ad4525ba8a93e611c21089722e8f99d"><div>
            <h3>
              <span class="m-dox-wrap-bumper">void Texturize::<wbr />CoherentIndex::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#a8ad4525ba8a93e611c21089722e8f99d" class="m-dox-self">getCoherentCandidate</a>(</span><span class="m-dox-wrap">const std::vector&lt;float&gt;&amp; targetDescriptor,
              const cv::Mat&amp; uv,
              const cv::Point2i&amp; at,
              const cv::Vec2i&amp; delta,
              <a href="class_texturize_1_1_coherent_index.html#a4de3432a308c040ee27da746301e7fcb" class="m-dox">TMatch</a>&amp; match) const <span class="m-label m-warning">protected</span></span></span>
            </h3>
            <p>Gets a coherent candidate from a neighborhood pixel.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">targetDescriptor</td>
                  <td>The descriptor to compare against a candidate from the exemplar sample.</td>
                </tr>
                <tr>
                  <td>uv</td>
                  <td>A two-dimensional map, where each pixel contains the continuous u and v coordinates of the exemplar texel at the pixel&#x27;s location.</td>
                </tr>
                <tr>
                  <td>at</td>
                  <td>The x and y coordinate within the uv map of the pixel to extract the coherent candidate from.</td>
                </tr>
                <tr>
                  <td>delta</td>
                  <td>The direction into which the coherent pixel should be extracted.</td>
                </tr>
                <tr>
                  <td>match</td>
                  <td>A buffer to store the coherent candidate in.</td>
                </tr>
              </tbody>
            </table>
<p>The method resolves the u and v coordinates of the pixel addressed by the <code>at</code> parameter and then applies the <code>delta</code> to it to get the actual coherent u and v coordinates from the <code>uv</code> map. It then resolves those coordinates in the exemplar and shifts them into negative <code>delta</code> location. The descriptor retrieved by this process is then compared towards the <code>targetDescriptor</code>. The result is stored inside <code>match</code>.</p>
          </div></section>
        </section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-dox-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-dox-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-dox-search-content">
          <input type="search" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" />
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            Search for symbols, directories, files, pages or modules. You can omit any
            prefix from the symbol or file path; adding a <code>:</code> or <code>/</code>
            suffix lists all members of given symbol or directory. Navigate through the
            list using <span class="m-label m-dim">&darr;</span> and
            <span class="m-label m-dim">&uarr;</span>, press
            <span class="m-label m-dim">Enter</span> to go.
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search.js"></script>
<script src="searchdata.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Texturize. Created by <a href="https://doxygen.org/">Doxygen</a> 1.8.14 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>