<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Texturize::FeatureMatchingIndex class | Texturize</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-texturize+doxygen.compiled.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <a href="index.html" id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">Texturize</a>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-dox-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path d="m6 0c-3.3144 0-6 2.6856-6 6 0 3.3144 2.6856 6 6 6 1.4858 0 2.8463-0.54083 3.8945-1.4355-0.0164 0.33797 0.14734 0.75854 0.5 1.1504l3.2227 3.7891c0.55185 0.6139 1.4517 0.66544 2.002 0.11524 0.55022-0.55022 0.49866-1.4501-0.11524-2.002l-3.7891-3.2246c-0.39184-0.35266-0.81242-0.51469-1.1504-0.5 0.89472-1.0482 1.4355-2.4088 1.4355-3.8945 0-3.3128-2.6856-5.998-6-5.998zm0 1.5625a4.4375 4.4375 0 0 1 4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375-4.4375 4.4375 4.4375 0 0 1 4.4375-4.4375z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li>
              <a href="getting-started.html">Getting started</a>
              <ol>
                <li><a href="getting-started-build.html">Creating the project using CMake</a></li>
                <li><a href="getting-started-sandbox.html">Using the Sandbox application</a></li>
              </ol>
            </li>
            <li>
              <a href="tutorial.html">Tutorials</a>
              <ol>
                <li><a href="tutorial-filter.html">Implementing custom filters</a></li>
                <li><a href="tutorial-search-space.html">Creating a search space</a></li>
                <li><a href="tutorial-search-index.html">Implementing a search index</a></li>
                <li><a href="tutorial-synthesizer.html">Writing your own synthesizer</a></li>
              </ol>
            </li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="modules.html">Modules</a></li>
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="namespaces.html">Namespaces</a></li>
            <li class="m-show-m"><a href="#search" class="m-dox-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <path d="m6 0c-3.3144 0-6 2.6856-6 6 0 3.3144 2.6856 6 6 6 1.4858 0 2.8463-0.54083 3.8945-1.4355-0.0164 0.33797 0.14734 0.75854 0.5 1.1504l3.2227 3.7891c0.55185 0.6139 1.4517 0.66544 2.002 0.11524 0.55022-0.55022 0.49866-1.4501-0.11524-2.002l-3.7891-3.2246c-0.39184-0.35266-0.81242-0.51469-1.1504-0.5 0.89472-1.0482 1.4355-2.4088 1.4355-3.8945 0-3.3128-2.6856-5.998-6-5.998zm0 1.5625a4.4375 4.4375 0 0 1 4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375 4.4375 4.4375 4.4375 0 0 1-4.4375-4.4375 4.4375 4.4375 0 0 1 4.4375-4.4375z"/>
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="namespace_texturize.html">Texturize</a>::<wbr/></span>FeatureMatchingIndex <span class="m-thin">class</span>
        </h1>
        <p>A search index based on OpenCV&#x27;s feature matching library.</p>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li>
              Reference
              <ul>
                <li><a href="#base-classes">Base classes</a></li>
                <li><a href="#typeless-methods">Constructors, destructors, conversion operators</a></li>
                <li><a href="#pub-methods">Public functions</a></li>
              </ul>
            </li>
          </ul>
        </div>
<aside class="m-note m-danger"><h4><a href="deprecated.html#_deprecated000006" class="m-dox">Deprecated</a></h4><p>Note that this class is deprecated, due to poor quality and may be either reworked or removed in future releases. It is not recommendet to use it in is current form.</p></aside>
        <section id="base-classes">
          <h2><a href="#base-classes">Base classes</a></h2>
          <dl class="m-dox">
            <dt>
              class <a href="class_texturize_1_1_search_index.html" class="m-dox">SearchIndex</a>
            </dt>
            <dd>Implements a search index, based on pixel neighborhood appearances.</dd>
          </dl>
        </section>
        <section id="typeless-methods">
          <h2><a href="#typeless-methods">Constructors, destructors, conversion operators</a></h2>
          <dl class="m-dox">
            <dt>
              <span class="m-dox-wrap-bumper"><a href="#a0295739737b9532b42602cee16145a50" class="m-dox-self" name="a0295739737b9532b42602cee16145a50">FeatureMatchingIndex</a>(</span><span class="m-dox-wrap">const <a href="class_texturize_1_1_i_search_space.html" class="m-dox">ISearchSpace</a>* searchSpace,
              const cv::NormTypes norm,
              const bool crossCheck = false)</span>
            </dt>
            <dd>Creates a search index based on brute force matching.</dd>
            <dt>
              <span class="m-dox-wrap-bumper"><a href="#a8b1999c28a225c803600b235623be2bb" class="m-dox-self" name="a8b1999c28a225c803600b235623be2bb">FeatureMatchingIndex</a>(</span><span class="m-dox-wrap">const <a href="class_texturize_1_1_i_search_space.html" class="m-dox">ISearchSpace</a>* searchSpace,
              cv::flann::IndexParams* indexParams = new cv::flann::KDTreeIndexParams(),
              cv::flann::SearchParams* searchParams = new cv::flann::SearchParams())</span>
            </dt>
            <dd>Creates a search index that uses fast approximate nearest neighbor matchning (FLANN).</dd>
          </dl>
        </section>
        <section id="pub-methods">
          <h2><a href="#pub-methods">Public functions</a></h2>
          <dl class="m-dox">
            <dt>
              <span class="m-dox-wrap-bumper">auto <a href="#afc54c8ac0ef514bfc102d01f3027babd" class="m-dox">calculateNeighborhoodDescriptors</a>(</span><span class="m-dox-wrap">) const -&gt; cv::Mat</span>
            </dt>
            <dd>Calculates a set of neighborhood-descriptors for the search-space exemplar.</dd>
            <dt>
              <span class="m-dox-wrap-bumper">auto <a href="#a770c795ff8d3804c1242e0971caa0e26" class="m-dox">calculateNeighborhoodDescriptors</a>(</span><span class="m-dox-wrap">const cv::Mat&amp; uv) const -&gt; cv::Mat</span>
            </dt>
            <dd>Calculates a set of neighborhood-descriptors for the search-space exemplar.</dd>
            <dt>
              <span class="m-dox-wrap-bumper">auto <a href="#a219ebdf5d37bf6119a1b39ab039b9ab4" class="m-dox">findNearestNeighbor</a>(</span><span class="m-dox-wrap">const cv::Mat&amp; descriptors,
              const cv::Mat&amp; uv,
              const cv::Point2i&amp; at,
              cv::Vec2f&amp; match,
              float minDist = 0.0f,
              float* dist = nullptr) const override -&gt; bool <span class="m-label m-flat m-warning">virtual</span></span>
            </dt>
            <dd>Finds the best match for a given pixel neighborhood.</dd>
            <dt>
              <span class="m-dox-wrap-bumper">auto <a href="#a33f4f641b56d6c0e8e5b6c4e418ed09d" class="m-dox">findNearestNeighbors</a>(</span><span class="m-dox-wrap">const cv::Mat&amp; descriptors,
              const cv::Mat&amp; uv,
              const cv::Point2i&amp; at,
              std::vector&lt;cv::Vec2f&gt;&amp; matches,
              const int k = 1,
              float minDist = 0.0f,
              std::vector&lt;float&gt;* dist = nullptr) const override -&gt; bool <span class="m-label m-flat m-warning">virtual</span></span>
            </dt>
            <dd>Finds the best matches for a given pixel neighborhood.</dd>
          </dl>
        </section>
        <section>
          <h2>Function documentation</h2>
          <section class="m-dox-details" id="afc54c8ac0ef514bfc102d01f3027babd"><div>
            <h3>
              <span class="m-dox-wrap-bumper">cv::Mat Texturize::<wbr />FeatureMatchingIndex::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#afc54c8ac0ef514bfc102d01f3027babd" class="m-dox-self">calculateNeighborhoodDescriptors</a>(</span><span class="m-dox-wrap">) const</span></span>
            </h3>
            <p>Calculates a set of neighborhood-descriptors for the search-space exemplar.</p>
            <table class="m-table m-fullwidth m-flat">
              <tfoot>
                <tr>
                  <th style="width: 1%">Returns</th>
                  <td>A set of descriptors for the whole search-space exemplar, where each row contains one descriptor.</td>
                </tr>
              </tfoot>
            </table>
<p>The method takes the exemplar that is used to initialize the search space, used by the current index instance and extracts so called <em>proxy-pixels</em> for the neighborhood of each pixel. It then uses them to project them to a set of descriptors that can be used to match them with their nearest neighbors.</p><p><em>Proxy-pixels</em> are the four pixels diagonally adjecent pixels of a certain pixel within an exemplar. They are used to predict the appearance of this pixel. The actual pixel values are later found by matching the resulting neighborhood descriptor from those proxy-pixels with a pre-computed descriptor set.</p><p>This overload generates a UV map with equal dimensions to the search-space exemplar. The UV map get&#x27;s filled with coordinates between <code>0.0</code> and <code>1.0</code>.</p>
          </div></section>
          <section class="m-dox-details" id="a770c795ff8d3804c1242e0971caa0e26"><div>
            <h3>
              <span class="m-dox-wrap-bumper">cv::Mat Texturize::<wbr />FeatureMatchingIndex::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#a770c795ff8d3804c1242e0971caa0e26" class="m-dox-self">calculateNeighborhoodDescriptors</a>(</span><span class="m-dox-wrap">const cv::Mat&amp; uv) const</span></span>
            </h3>
            <p>Calculates a set of neighborhood-descriptors for the search-space exemplar.</p>
            <table class="m-table m-fullwidth m-flat">
              <tfoot>
                <tr>
                  <th style="width: 1%">Returns</th>
                  <td>A set of descriptors for each point within the UV map, where each row contains one descriptor.</td>
                </tr>
              </tfoot>
            </table>
<p>The method takes the exemplar that is used to initialize the search space, used by the current index instance and extracts so called <em>proxy-pixels</em> for the neighborhood of each pixel. It then uses them to project them to a set of descriptors that can be used to match them with their nearest neighbors.</p><p><em>Proxy-pixels</em> are the four pixels diagonally adjecent pixels of a certain pixel within an exemplar. They are used to predict the appearance of this pixel. The actual pixel values are later found by matching the resulting neighborhood descriptor from those proxy-pixels with a pre-computed descriptor set.</p><p>This overload uses a UV map to fetch individual pixels from the search-space exemplar.</p>
          </div></section>
          <section class="m-dox-details" id="a219ebdf5d37bf6119a1b39ab039b9ab4"><div>
            <h3>
              <span class="m-dox-wrap-bumper">bool Texturize::<wbr />FeatureMatchingIndex::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#a219ebdf5d37bf6119a1b39ab039b9ab4" class="m-dox-self">findNearestNeighbor</a>(</span><span class="m-dox-wrap">const cv::Mat&amp; descriptors,
              const cv::Mat&amp; uv,
              const cv::Point2i&amp; at,
              cv::Vec2f&amp; match,
              float minDist = 0.0f,
              float* dist = nullptr) const override <span class="m-label m-warning">virtual</span></span></span>
            </h3>
            <p>Finds the best match for a given pixel neighborhood.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">descriptors</td>
                  <td>An array, containing all neighborhood descriptors of the currently synthesized sample.</td>
                </tr>
                <tr>
                  <td>uv</td>
                  <td>A two-dimensional map, where each pixel contains the continuous u and v coordinates of the exemplar texel at the pixel&#x27;s location.</td>
                </tr>
                <tr>
                  <td>at</td>
                  <td>The x and y coordinates of the pixel to match.</td>
                </tr>
                <tr>
                  <td>match</td>
                  <td>The u and v coordinates of the best match.</td>
                </tr>
                <tr>
                  <td>minDist</td>
                  <td>The minimum distance between the source texel and match within the exemplar.</td>
                </tr>
                <tr>
                  <td>dist</td>
                  <td>A pointer to a value, containing the distance between the source texel and match, after the method has returned.</td>
                </tr>
              </tbody>
              <tfoot>
                <tr>
                  <th>Returns</th>
                  <td>True, if a match has been found, given the provided constraints.</td>
                </tr>
              </tfoot>
            </table>
<p>Actual synthesis is a two-phase process. After analyzing the exemplar, a set of neighborhood descriptors is stored within a <em>search space</em>. Those neighborhoods, however, are not necessarily present within the synthesized sample. In order to match neighborhoods anyway, a runtime descriptor needs to be calculated for each neighborhood of the sample. A set of those descriptors is provided alongside an uv map. The index then extracts the descriptor at a given location (by resolving the <code>at</code> parameter inside the uv map) and tries to find close matches within the exemplar descriptors. Note that the definition of the distance parameter depends on the implementation of the actual index. Typically the <code>minDist</code> parameter contains a geometric distance between two texels, whilst the <code>dist</code> parameter describes the L2 distance between both texel vectors, i.e. their &quot;similarity&quot;.</p><aside class="m-note m-default"><h4>See also</h4><p><a href="class_texturize_1_1_i_search_space.html" class="m-dox">Texturize::<wbr />ISearchSpace</a></p></aside>
          </div></section>
          <section class="m-dox-details" id="a33f4f641b56d6c0e8e5b6c4e418ed09d"><div>
            <h3>
              <span class="m-dox-wrap-bumper">bool Texturize::<wbr />FeatureMatchingIndex::<wbr /></span><span class="m-dox-wrap"><span class="m-dox-wrap-bumper"><a href="#a33f4f641b56d6c0e8e5b6c4e418ed09d" class="m-dox-self">findNearestNeighbors</a>(</span><span class="m-dox-wrap">const cv::Mat&amp; descriptors,
              const cv::Mat&amp; uv,
              const cv::Point2i&amp; at,
              std::vector&lt;cv::Vec2f&gt;&amp; matches,
              const int k = 1,
              float minDist = 0.0f,
              std::vector&lt;float&gt;* dist = nullptr) const override <span class="m-label m-warning">virtual</span></span></span>
            </h3>
            <p>Finds the best matches for a given pixel neighborhood.</p>
            <table class="m-table m-fullwidth m-flat">
              <thead>
                <tr><th colspan="2">Parameters</th></tr>
              </thead>
              <tbody>
                <tr>
                  <td style="width: 1%">descriptors</td>
                  <td>An array, containing all neighborhood descriptors of the currently synthesized sample.</td>
                </tr>
                <tr>
                  <td>uv</td>
                  <td>A two-dimensional map, where each pixel contains the continuous u and v coordinates of the exemplar texel at the pixel&#x27;s location.</td>
                </tr>
                <tr>
                  <td>at</td>
                  <td>The x and y coordinates of the pixel to match.</td>
                </tr>
                <tr>
                  <td>matches</td>
                  <td>A vector of u and v coordinates of the best matches.</td>
                </tr>
                <tr>
                  <td>k</td>
                  <td>The number of matches to find.</td>
                </tr>
                <tr>
                  <td>minDist</td>
                  <td>The minimum distance between the source texel and a match within the exemplar.</td>
                </tr>
                <tr>
                  <td>dist</td>
                  <td>A pointer to a vector, containing the distances between the source texel and match, after the method has returned.</td>
                </tr>
              </tbody>
              <tfoot>
                <tr>
                  <th>Returns</th>
                  <td>True, if at least one match has been found, given the provided constraints.</td>
                </tr>
              </tfoot>
            </table>
<p>This method typically runs <code>findNearestNeighbor</code> multiple times, excluding the already found matches. Please refer to the notes there.</p><aside class="m-note m-default"><h4>See also</h4><p><a href="class_texturize_1_1_i_search_space.html" class="m-dox">Texturize::<wbr />ISearchSpace</a></p><p><a href="class_texturize_1_1_i_search_index.html#ab5b8b56d1ff61881c2cacf5f84b9e230" class="m-dox">Texturize::<wbr />ISearchIndex::<wbr />findNearestNeighbor</a></p></aside>
          </div></section>
        </section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-dox-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-dox-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-dox-search-content">
          <input type="search" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" />
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            Search for symbols, directories, files, pages or modules. You can omit any
            prefix from the symbol or file path; adding a <code>:</code> or <code>/</code>
            suffix lists all members of given symbol or directory. Navigate through the
            list using <span class="m-label m-dim">&darr;</span> and
            <span class="m-label m-dim">&uarr;</span>, press
            <span class="m-label m-dim">Enter</span> to go.
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search.js"></script>
<script src="searchdata.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Texturize. Created by <a href="http://doxygen.org/">Doxygen</a> 1.8.13 and <a href="http://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>